{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/luisleyva98/tarea-1-gdd?scriptVersionId=133867723\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"ce707ebe","metadata":{"id":"O2vZlgQIqkLL","papermill":{"duration":0.009966,"end_time":"2023-06-17T04:43:50.902451","exception":false,"start_time":"2023-06-17T04:43:50.892485","status":"completed"},"tags":[]},"source":["# **Tarea 1** (fecha de entrega: 17 de Junio 2023)\n"]},{"cell_type":"markdown","id":"ccdf4bd2","metadata":{"id":"sKzfHzvtb_rG","papermill":{"duration":0.009804,"end_time":"2023-06-17T04:43:50.921448","exception":false,"start_time":"2023-06-17T04:43:50.911644","status":"completed"},"tags":[]},"source":["Esta tarea consiste en 7 preguntas, de las cuales solo se considerarán las 6 mejores para el cálculo de la nota. **Se espera el codigo asociado a la respuesta y comentarios que hagan comprensible la lectura de la solución**. Puede entregar la tarea en el formato que estime conveniente (doc, pdf, script de R, url de Kaggle) pero tenga en cuenta que debe adjuntar el código utilizado. Se recomienda el uso de un notebook de R en la plataforma Kaggle (recordar dejar el notebook compartido con el ayudante para que este pueda abrirlo).\n","\n"]},{"cell_type":"markdown","id":"1aaed5ab","metadata":{"id":"B4hwoL79fqcO","papermill":{"duration":0.008287,"end_time":"2023-06-17T04:43:50.938222","exception":false,"start_time":"2023-06-17T04:43:50.929935","status":"completed"},"tags":[]},"source":["# Enunciado"]},{"cell_type":"markdown","id":"0bf03d80","metadata":{"id":"FwitH8cjO9TY","papermill":{"duration":0.008329,"end_time":"2023-06-17T04:43:50.954736","exception":false,"start_time":"2023-06-17T04:43:50.946407","status":"completed"},"tags":[]},"source":["Tu empresa fue contratada por la Asociación de Navegación Marítima de Chile para manejar la información de buques, navieras, y distintas rutas que bueques realizan para las navieras. Similarmente, se guardará la información de personal marino, y en cuales buques estos trabajan. Por ahora, tu desarrollo te ha llevado definir el siguiente esquema:\n","\n","* $\\color{green}{\\textbf{Buques}}(\\color{red}{\\underline{\\text{buqueId}}}, \\color{red}{\\text{nombre}}, \\color{red}{\\text{capacidad}}, \\color{red}{\\text{capitanId}})$ \n","* $\\color{green}{\\textbf{Navieras}}(\\color{red}{\\underline{\\text{navieraId}}}, \\color{red}{\\text{nombre}}, \\color{red}{\\text{pais}})$\n","* $\\color{green}{\\textbf{Navegaciones}}(\\color{red}{\\underline{\\text{buqueId}}}, \\color{red}{\\underline{\\text{navieraId}}},  \\color{red}{{\\text{ruta}}})$\n","* $\\color{green}{\\textbf{Personal}}(\\color{red}{\\underline{\\text{personalId}}}, \n","\\color{red}{{\\text{nombre}}}, \\color{red}{{\\text{edad}}},  \\color{red}{\\text{nacionalidad}})$\n","* $\\color{green}{\\textbf{TrabajaEn}}(\\color{red}{\\underline{\\text{personalId}}}, \n","\\color{red}{\\underline{\\text{buqueId}}})$\n","\n","Cómo un ejemplo, más abajo se muestra una instancia válida de tu esquema (puede ser que se revise la tarea con otra instancia). Es importante entender que un mismo buque puede ser contratado por varias naveras para realizar distintas rutas de trasbordo. Similarmente, una persona puede trabajar en más de un buque.\n"]},{"cell_type":"code","execution_count":null,"id":"4b7ff082","metadata":{"papermill":{"duration":0.008205,"end_time":"2023-06-17T04:43:50.971167","exception":false,"start_time":"2023-06-17T04:43:50.962962","status":"completed"},"tags":[]},"outputs":[],"source":[]},{"cell_type":"markdown","id":"98d027fb","metadata":{"id":"ISXM4xT1TMP8","papermill":{"duration":0.008131,"end_time":"2023-06-17T04:43:50.987418","exception":false,"start_time":"2023-06-17T04:43:50.979287","status":"completed"},"tags":[]},"source":["## Reglas: \n"," - Las tablas que se entreguen como respuestas **no deben contener tuplas ni atributos adicionales a lo que se pregunta**.\n"," - No deben permitir que R modifique el nombre de un atributo por su cuenta (al hacer un inner_join de una tabla con ella misma por ejemplo), para evitar esto usen el comando rename.\n"," - Solo se debe responder usando los operadores vistos durante la segunda parte de la clase 2:\n","  - select\n","  - filter\n","  - union\n","  - rename\n","  - crossing\n","  - join\n","  - setdiff\n","  - anti_join"]},{"cell_type":"markdown","id":"2273e88a","metadata":{"id":"VS7BKzPjfuc9","papermill":{"duration":0.008561,"end_time":"2023-06-17T04:43:51.004216","exception":false,"start_time":"2023-06-17T04:43:50.995655","status":"completed"},"tags":[]},"source":["# Bases de datos"]},{"cell_type":"code","execution_count":1,"id":"a59832cf","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:51.02608Z","iopub.status.busy":"2023-06-17T04:43:51.02298Z","iopub.status.idle":"2023-06-17T04:43:52.087935Z","shell.execute_reply":"2023-06-17T04:43:52.086263Z"},"id":"88UivwhCOPje","outputId":"df934e8f-fb2a-466f-d49e-690257466d6f","papermill":{"duration":1.077803,"end_time":"2023-06-17T04:43:52.090288","exception":false,"start_time":"2023-06-17T04:43:51.012485","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["── \u001b[1mAttaching core tidyverse packages\u001b[22m ──────────────────────── tidyverse 2.0.0 ──\n","\u001b[32m✔\u001b[39m \u001b[34mdplyr    \u001b[39m 1.1.2     \u001b[32m✔\u001b[39m \u001b[34mreadr    \u001b[39m 2.1.4\n","\u001b[32m✔\u001b[39m \u001b[34mforcats  \u001b[39m 1.0.0     \u001b[32m✔\u001b[39m \u001b[34mstringr  \u001b[39m 1.5.0\n","\u001b[32m✔\u001b[39m \u001b[34mggplot2  \u001b[39m 3.4.2     \u001b[32m✔\u001b[39m \u001b[34mtibble   \u001b[39m 3.2.1\n","\u001b[32m✔\u001b[39m \u001b[34mlubridate\u001b[39m 1.9.2     \u001b[32m✔\u001b[39m \u001b[34mtidyr    \u001b[39m 1.3.0\n","\u001b[32m✔\u001b[39m \u001b[34mpurrr    \u001b[39m 1.0.1     \n","── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m masks \u001b[34mstats\u001b[39m::filter()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m    masks \u001b[34mstats\u001b[39m::lag()\n","\u001b[36mℹ\u001b[39m Use the conflicted package (\u001b[3m\u001b[34m<http://conflicted.r-lib.org/>\u001b[39m\u001b[23m) to force all conflicts to become errors\n"]}],"source":["library(tidyverse)"]},{"cell_type":"code","execution_count":2,"id":"4693c4e5","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.139433Z","iopub.status.busy":"2023-06-17T04:43:52.110132Z","iopub.status.idle":"2023-06-17T04:43:52.163259Z","shell.execute_reply":"2023-06-17T04:43:52.161586Z"},"id":"ruWROIxuRTmR","papermill":{"duration":0.066596,"end_time":"2023-06-17T04:43:52.165581","exception":false,"start_time":"2023-06-17T04:43:52.098985","status":"completed"},"tags":[]},"outputs":[],"source":["buques <- tribble(\n","  ~buqueId, ~nombre, ~capacidad, ~capitanId,\n","  #-------/---------/----------/-----------\n","  \"b1\", \"El Inundado\", 4000, \"p22\",\n","  \"b2\", \"Gotas Saladas\", 2010, \"p1\",\n","  \"b3\", \"Falucho\", 4085, \"p21\",\n","  \"b4\", \"Lento\", 2989, \"p33\"\n",")\n","\n","navieras <- tribble(\n","  ~navieraId, ~nombre, ~pais,\n","  #-------/---------/----------\n","  \"n1\", \"Lagos del Sur\", \"Chile\",\n","  \"n2\", \"Somarco\", \"Chile\",\n","  \"n3\", \"Ultramar\", \"Argentina\",\n","  \"n4\", \"Broom\", \"Chile\"\n",")\n","\n","navegaciones <- tribble(\n","  ~buqueId, ~navieraId, ~ruta,\n","  #-------/---------/----------\n","  \"b1\", \"n1\", \"Chiloe Norte\",\n","  \"b2\", \"n1\", \"Cruce Lago General Carrera\",\n","  \"b1\", \"n2\", \"Puerto Murta - Chile Chico\",\n","  \"b3\", \"n3\", \"Chaiten - Hornopiren\"\n",")\n","\n","personal <- tribble(\n","  ~personalId, ~nombre, ~edad, ~nacionalidad,\n","  #-------/---------/----------/-----------\n","  \"p1\", \"Ian McIntosh\", 32, \"Escocia\",\n","  \"p2\", \"Christian Rutter\", 24, \"Alemania\",\n","  \"p3\", \"Mark Boyle\", 33, \"EE.UU.\",\n","  \"p4\", \"Victoria Kostylev\", 48, \"Chile\",\n","  \"p5\", \"Ian Stolberg\", 44, \"Suecia\"\n",")\n","\n","trabajaEn <- tribble(\n","  ~personalId, ~buqueId,\n","  #-------/---------\n","  \"p1\", \"b2\",\n","  \"p1\", \"b4\",\n","  \"p3\", \"b4\",\n","  \"p4\", \"b4\",\n","  \"p2\", \"b3\",\n","  \"p2\", \"b2\",\n","  \"p3\", \"b3\"\n",")"]},{"cell_type":"code","execution_count":3,"id":"8d4990d5","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.186203Z","iopub.status.busy":"2023-06-17T04:43:52.184765Z","iopub.status.idle":"2023-06-17T04:43:52.214039Z","shell.execute_reply":"2023-06-17T04:43:52.212407Z"},"id":"ZDRG_W1uLzT2","outputId":"e9eb0ef6-038a-41c5-f83c-26b0f881ff7f","papermill":{"duration":0.041885,"end_time":"2023-06-17T04:43:52.216263","exception":false,"start_time":"2023-06-17T04:43:52.174378","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 4 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>buqueId</th><th scope=col>nombre</th><th scope=col>capacidad</th><th scope=col>capitanId</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>b1</td><td>El Inundado  </td><td>4000</td><td>p22</td></tr>\n","\t<tr><td>b2</td><td>Gotas Saladas</td><td>2010</td><td>p1 </td></tr>\n","\t<tr><td>b3</td><td>Falucho      </td><td>4085</td><td>p21</td></tr>\n","\t<tr><td>b4</td><td>Lento        </td><td>2989</td><td>p33</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 4 × 4\n","\\begin{tabular}{llll}\n"," buqueId & nombre & capacidad & capitanId\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t b1 & El Inundado   & 4000 & p22\\\\\n","\t b2 & Gotas Saladas & 2010 & p1 \\\\\n","\t b3 & Falucho       & 4085 & p21\\\\\n","\t b4 & Lento         & 2989 & p33\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 4 × 4\n","\n","| buqueId &lt;chr&gt; | nombre &lt;chr&gt; | capacidad &lt;dbl&gt; | capitanId &lt;chr&gt; |\n","|---|---|---|---|\n","| b1 | El Inundado   | 4000 | p22 |\n","| b2 | Gotas Saladas | 2010 | p1  |\n","| b3 | Falucho       | 4085 | p21 |\n","| b4 | Lento         | 2989 | p33 |\n","\n"],"text/plain":["  buqueId nombre        capacidad capitanId\n","1 b1      El Inundado   4000      p22      \n","2 b2      Gotas Saladas 2010      p1       \n","3 b3      Falucho       4085      p21      \n","4 b4      Lento         2989      p33      "]},"metadata":{},"output_type":"display_data"}],"source":["buques"]},{"cell_type":"code","execution_count":4,"id":"a11d00c2","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.236978Z","iopub.status.busy":"2023-06-17T04:43:52.23558Z","iopub.status.idle":"2023-06-17T04:43:52.266742Z","shell.execute_reply":"2023-06-17T04:43:52.264673Z"},"id":"nH6WHZc4L1Ny","outputId":"657e641d-05f9-46a3-cabe-1c9b7ea479c1","papermill":{"duration":0.044322,"end_time":"2023-06-17T04:43:52.269425","exception":false,"start_time":"2023-06-17T04:43:52.225103","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 4 × 3</caption>\n","<thead>\n","\t<tr><th scope=col>navieraId</th><th scope=col>nombre</th><th scope=col>pais</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>n1</td><td>Lagos del Sur</td><td>Chile    </td></tr>\n","\t<tr><td>n2</td><td>Somarco      </td><td>Chile    </td></tr>\n","\t<tr><td>n3</td><td>Ultramar     </td><td>Argentina</td></tr>\n","\t<tr><td>n4</td><td>Broom        </td><td>Chile    </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 4 × 3\n","\\begin{tabular}{lll}\n"," navieraId & nombre & pais\\\\\n"," <chr> & <chr> & <chr>\\\\\n","\\hline\n","\t n1 & Lagos del Sur & Chile    \\\\\n","\t n2 & Somarco       & Chile    \\\\\n","\t n3 & Ultramar      & Argentina\\\\\n","\t n4 & Broom         & Chile    \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 4 × 3\n","\n","| navieraId &lt;chr&gt; | nombre &lt;chr&gt; | pais &lt;chr&gt; |\n","|---|---|---|\n","| n1 | Lagos del Sur | Chile     |\n","| n2 | Somarco       | Chile     |\n","| n3 | Ultramar      | Argentina |\n","| n4 | Broom         | Chile     |\n","\n"],"text/plain":["  navieraId nombre        pais     \n","1 n1        Lagos del Sur Chile    \n","2 n2        Somarco       Chile    \n","3 n3        Ultramar      Argentina\n","4 n4        Broom         Chile    "]},"metadata":{},"output_type":"display_data"}],"source":["navieras"]},{"cell_type":"code","execution_count":5,"id":"76c5f2aa","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.290867Z","iopub.status.busy":"2023-06-17T04:43:52.289436Z","iopub.status.idle":"2023-06-17T04:43:52.312772Z","shell.execute_reply":"2023-06-17T04:43:52.31076Z"},"id":"MWj2-dJVL1uZ","outputId":"5160a959-d9c5-48c6-b946-653c7dfd3cf9","papermill":{"duration":0.036728,"end_time":"2023-06-17T04:43:52.315548","exception":false,"start_time":"2023-06-17T04:43:52.27882","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 4 × 3</caption>\n","<thead>\n","\t<tr><th scope=col>buqueId</th><th scope=col>navieraId</th><th scope=col>ruta</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>b1</td><td>n1</td><td>Chiloe Norte              </td></tr>\n","\t<tr><td>b2</td><td>n1</td><td>Cruce Lago General Carrera</td></tr>\n","\t<tr><td>b1</td><td>n2</td><td>Puerto Murta - Chile Chico</td></tr>\n","\t<tr><td>b3</td><td>n3</td><td>Chaiten - Hornopiren      </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 4 × 3\n","\\begin{tabular}{lll}\n"," buqueId & navieraId & ruta\\\\\n"," <chr> & <chr> & <chr>\\\\\n","\\hline\n","\t b1 & n1 & Chiloe Norte              \\\\\n","\t b2 & n1 & Cruce Lago General Carrera\\\\\n","\t b1 & n2 & Puerto Murta - Chile Chico\\\\\n","\t b3 & n3 & Chaiten - Hornopiren      \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 4 × 3\n","\n","| buqueId &lt;chr&gt; | navieraId &lt;chr&gt; | ruta &lt;chr&gt; |\n","|---|---|---|\n","| b1 | n1 | Chiloe Norte               |\n","| b2 | n1 | Cruce Lago General Carrera |\n","| b1 | n2 | Puerto Murta - Chile Chico |\n","| b3 | n3 | Chaiten - Hornopiren       |\n","\n"],"text/plain":["  buqueId navieraId ruta                      \n","1 b1      n1        Chiloe Norte              \n","2 b2      n1        Cruce Lago General Carrera\n","3 b1      n2        Puerto Murta - Chile Chico\n","4 b3      n3        Chaiten - Hornopiren      "]},"metadata":{},"output_type":"display_data"}],"source":["navegaciones"]},{"cell_type":"code","execution_count":6,"id":"99ed225c","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.337147Z","iopub.status.busy":"2023-06-17T04:43:52.335568Z","iopub.status.idle":"2023-06-17T04:43:52.360195Z","shell.execute_reply":"2023-06-17T04:43:52.358149Z"},"id":"PixQePtYL2F1","outputId":"5233e35a-ac24-4533-b1cf-c4eacc5bd893","papermill":{"duration":0.03781,"end_time":"2023-06-17T04:43:52.362488","exception":false,"start_time":"2023-06-17T04:43:52.324678","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 5 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>personalId</th><th scope=col>nombre</th><th scope=col>edad</th><th scope=col>nacionalidad</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia </td></tr>\n","\t<tr><td>p2</td><td>Christian Rutter </td><td>24</td><td>Alemania</td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.  </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile   </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia  </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 5 × 4\n","\\begin{tabular}{llll}\n"," personalId & nombre & edad & nacionalidad\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p1 & Ian McIntosh      & 32 & Escocia \\\\\n","\t p2 & Christian Rutter  & 24 & Alemania\\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU.  \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile   \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia  \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 5 × 4\n","\n","| personalId &lt;chr&gt; | nombre &lt;chr&gt; | edad &lt;dbl&gt; | nacionalidad &lt;chr&gt; |\n","|---|---|---|---|\n","| p1 | Ian McIntosh      | 32 | Escocia  |\n","| p2 | Christian Rutter  | 24 | Alemania |\n","| p3 | Mark Boyle        | 33 | EE.UU.   |\n","| p4 | Victoria Kostylev | 48 | Chile    |\n","| p5 | Ian Stolberg      | 44 | Suecia   |\n","\n"],"text/plain":["  personalId nombre            edad nacionalidad\n","1 p1         Ian McIntosh      32   Escocia     \n","2 p2         Christian Rutter  24   Alemania    \n","3 p3         Mark Boyle        33   EE.UU.      \n","4 p4         Victoria Kostylev 48   Chile       \n","5 p5         Ian Stolberg      44   Suecia      "]},"metadata":{},"output_type":"display_data"}],"source":["personal"]},{"cell_type":"code","execution_count":7,"id":"a896acd3","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.384513Z","iopub.status.busy":"2023-06-17T04:43:52.382968Z","iopub.status.idle":"2023-06-17T04:43:52.405321Z","shell.execute_reply":"2023-06-17T04:43:52.403671Z"},"id":"kS7eCh0vLXnu","outputId":"81986012-1b95-4459-9352-a43cea05ffad","papermill":{"duration":0.035638,"end_time":"2023-06-17T04:43:52.407566","exception":false,"start_time":"2023-06-17T04:43:52.371928","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 7 × 2</caption>\n","<thead>\n","\t<tr><th scope=col>personalId</th><th scope=col>buqueId</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p1</td><td>b2</td></tr>\n","\t<tr><td>p1</td><td>b4</td></tr>\n","\t<tr><td>p3</td><td>b4</td></tr>\n","\t<tr><td>p4</td><td>b4</td></tr>\n","\t<tr><td>p2</td><td>b3</td></tr>\n","\t<tr><td>p2</td><td>b2</td></tr>\n","\t<tr><td>p3</td><td>b3</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 7 × 2\n","\\begin{tabular}{ll}\n"," personalId & buqueId\\\\\n"," <chr> & <chr>\\\\\n","\\hline\n","\t p1 & b2\\\\\n","\t p1 & b4\\\\\n","\t p3 & b4\\\\\n","\t p4 & b4\\\\\n","\t p2 & b3\\\\\n","\t p2 & b2\\\\\n","\t p3 & b3\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 7 × 2\n","\n","| personalId &lt;chr&gt; | buqueId &lt;chr&gt; |\n","|---|---|\n","| p1 | b2 |\n","| p1 | b4 |\n","| p3 | b4 |\n","| p4 | b4 |\n","| p2 | b3 |\n","| p2 | b2 |\n","| p3 | b3 |\n","\n"],"text/plain":["  personalId buqueId\n","1 p1         b2     \n","2 p1         b4     \n","3 p3         b4     \n","4 p4         b4     \n","5 p2         b3     \n","6 p2         b2     \n","7 p3         b3     "]},"metadata":{},"output_type":"display_data"}],"source":["trabajaEn"]},{"cell_type":"markdown","id":"67b93590","metadata":{"id":"F3gv4wEpU2FD","papermill":{"duration":0.009412,"end_time":"2023-06-17T04:43:52.4265","exception":false,"start_time":"2023-06-17T04:43:52.417088","status":"completed"},"tags":[]},"source":["# Pregunta 1\n","Encuentre los nombres de todos los buques con capacidad mayor o igual a 4000."]},{"cell_type":"markdown","id":"625451ee","metadata":{"papermill":{"duration":0.010158,"end_time":"2023-06-17T04:43:52.446055","exception":false,"start_time":"2023-06-17T04:43:52.435897","status":"completed"},"tags":[]},"source":["## Respuesta"]},{"cell_type":"code","execution_count":8,"id":"7b6475d8","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.468221Z","iopub.status.busy":"2023-06-17T04:43:52.466694Z","iopub.status.idle":"2023-06-17T04:43:52.533689Z","shell.execute_reply":"2023-06-17T04:43:52.531549Z"},"papermill":{"duration":0.081011,"end_time":"2023-06-17T04:43:52.536448","exception":false,"start_time":"2023-06-17T04:43:52.455437","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 2 × 1</caption>\n","<thead>\n","\t<tr><th scope=col>nombre</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>El Inundado</td></tr>\n","\t<tr><td>Falucho    </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 2 × 1\n","\\begin{tabular}{l}\n"," nombre\\\\\n"," <chr>\\\\\n","\\hline\n","\t El Inundado\\\\\n","\t Falucho    \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 2 × 1\n","\n","| nombre &lt;chr&gt; |\n","|---|\n","| El Inundado |\n","| Falucho     |\n","\n"],"text/plain":["  nombre     \n","1 El Inundado\n","2 Falucho    "]},"metadata":{},"output_type":"display_data"}],"source":["#Código\n","P1 <- buques %>%  \n","        filter(capacidad >= 4000)  %>%  #Filtro de cap mayor o igual a 400\n","        select(nombre)  #Solo presentar el nombre\n","\n","#Respuesta (Nombre: El Inundado y Falucho)\n","P1"]},{"cell_type":"markdown","id":"e4ea5fd5","metadata":{"id":"LfBQlYdWURwf","papermill":{"duration":0.009702,"end_time":"2023-06-17T04:43:52.556242","exception":false,"start_time":"2023-06-17T04:43:52.54654","status":"completed"},"tags":[]},"source":["# Pregunta 2\n","Encuentre los identificadores (personalId) de todo el personal que trabaja en el buque \"Falucho\" o \"Gotas Saladas\"."]},{"cell_type":"markdown","id":"8cd297a9","metadata":{"papermill":{"duration":0.009585,"end_time":"2023-06-17T04:43:52.575633","exception":false,"start_time":"2023-06-17T04:43:52.566048","status":"completed"},"tags":[]},"source":["## Respuesta"]},{"cell_type":"code","execution_count":9,"id":"9363532a","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.598354Z","iopub.status.busy":"2023-06-17T04:43:52.596867Z","iopub.status.idle":"2023-06-17T04:43:52.648435Z","shell.execute_reply":"2023-06-17T04:43:52.646393Z"},"id":"-1mVAyJHUaVB","papermill":{"duration":0.065375,"end_time":"2023-06-17T04:43:52.650751","exception":false,"start_time":"2023-06-17T04:43:52.585376","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A data.frame: 3 × 1</caption>\n","<thead>\n","\t<tr><th scope=col>personalId</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p1</td></tr>\n","\t<tr><td>p2</td></tr>\n","\t<tr><td>p3</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A data.frame: 3 × 1\n","\\begin{tabular}{l}\n"," personalId\\\\\n"," <chr>\\\\\n","\\hline\n","\t p1\\\\\n","\t p2\\\\\n","\t p3\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A data.frame: 3 × 1\n","\n","| personalId &lt;chr&gt; |\n","|---|\n","| p1 |\n","| p2 |\n","| p3 |\n","\n"],"text/plain":["  personalId\n","1 p1        \n","2 p2        \n","3 p3        "]},"metadata":{},"output_type":"display_data"}],"source":["#Código\n","P2 <- merge(personal, trabajaEn, by = \"personalId\") %>%  #Merge entre BD personal y Trabaja en\n","        merge(buques, by = \"buqueId\") %>%  #Merge con BD buques\n","        filter(nombre.y == \"Gotas Saladas\" | nombre.y == \"Falucho\") %>%  #Condicional de nombre del buque\n","        select(personalId)  #Mostrar únicamente el nombre\n","\n","#Eliminar duplicados\n","P2 <- union(P2,P2)\n","\n","#Respuesta (p1, p2 y p3)\n","P2"]},{"cell_type":"markdown","id":"30b5a911","metadata":{"id":"6DZxb3CZUals","papermill":{"duration":0.009626,"end_time":"2023-06-17T04:43:52.67026","exception":false,"start_time":"2023-06-17T04:43:52.660634","status":"completed"},"tags":[]},"source":["# Pregunta 3\n","Para validar si sus datos son consistente, asegure que cada capitan de un bote también está registrado en la tabla $\\texttt{Personal}$. Para esto, escriba la operación que encuentre todos los id de los capitanes que **no** aparecen en la tabla de personal. \n"]},{"cell_type":"markdown","id":"dc6d52cb","metadata":{"papermill":{"duration":0.010232,"end_time":"2023-06-17T04:43:52.690304","exception":false,"start_time":"2023-06-17T04:43:52.680072","status":"completed"},"tags":[]},"source":["### Hint de como usar setdiff y anti_join\n","\n","* **setdiff**: diferencia de conjuntos, si tienen una tabla y quieren restar las observaciones de otra pueden usar este comando. Ejemplo, a la tabla \"personal\" quiero quitarle las dos primeras filas (personal[1:2,]).\n","\n"]},{"cell_type":"code","execution_count":10,"id":"ab24b32e","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.713108Z","iopub.status.busy":"2023-06-17T04:43:52.711609Z","iopub.status.idle":"2023-06-17T04:43:52.745608Z","shell.execute_reply":"2023-06-17T04:43:52.743942Z"},"id":"6nr4T9B6G_C6","papermill":{"duration":0.047872,"end_time":"2023-06-17T04:43:52.747944","exception":false,"start_time":"2023-06-17T04:43:52.700072","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 3 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>personalId</th><th scope=col>nombre</th><th scope=col>edad</th><th scope=col>nacionalidad</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 3 × 4\n","\\begin{tabular}{llll}\n"," personalId & nombre & edad & nacionalidad\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p3 & Mark Boyle        & 33 & EE.UU.\\\\\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 3 × 4\n","\n","| personalId &lt;chr&gt; | nombre &lt;chr&gt; | edad &lt;dbl&gt; | nacionalidad &lt;chr&gt; |\n","|---|---|---|---|\n","| p3 | Mark Boyle        | 33 | EE.UU. |\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p5 | Ian Stolberg      | 44 | Suecia |\n","\n"],"text/plain":["  personalId nombre            edad nacionalidad\n","1 p3         Mark Boyle        33   EE.UU.      \n","2 p4         Victoria Kostylev 48   Chile       \n","3 p5         Ian Stolberg      44   Suecia      "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 0 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>personalId</th><th scope=col>nombre</th><th scope=col>edad</th><th scope=col>nacionalidad</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 0 × 4\n","\\begin{tabular}{llll}\n"," personalId & nombre & edad & nacionalidad\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 0 × 4\n","\n","| personalId &lt;chr&gt; | nombre &lt;chr&gt; | edad &lt;dbl&gt; | nacionalidad &lt;chr&gt; |\n","|---|---|---|---|\n","\n"],"text/plain":["     personalId nombre edad nacionalidad"]},"metadata":{},"output_type":"display_data"}],"source":["personal %>% setdiff(personal[1:2,])\n","\n","setdiff(personal, personal)"]},{"cell_type":"markdown","id":"f638edf0","metadata":{"papermill":{"duration":0.010109,"end_time":"2023-06-17T04:43:52.768413","exception":false,"start_time":"2023-06-17T04:43:52.758304","status":"completed"},"tags":[]},"source":["* **anti_join**: el anti_join funciona de forma parecida al setdiff, sin embargo en vez de restar las observaciones repetidas, elimina segun un conjunto de atributos repetido. Por ejemplo si a la tabla \"personal\" queremos quitarle las filas cuyo **id** que se encuentran en la tabla \"trabaja_en\""]},{"cell_type":"code","execution_count":11,"id":"82fdb7ca","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.791958Z","iopub.status.busy":"2023-06-17T04:43:52.790463Z","iopub.status.idle":"2023-06-17T04:43:52.820658Z","shell.execute_reply":"2023-06-17T04:43:52.818883Z"},"papermill":{"duration":0.044403,"end_time":"2023-06-17T04:43:52.822878","exception":false,"start_time":"2023-06-17T04:43:52.778475","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 1 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>personalId</th><th scope=col>nombre</th><th scope=col>edad</th><th scope=col>nacionalidad</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p5</td><td>Ian Stolberg</td><td>44</td><td>Suecia</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 1 × 4\n","\\begin{tabular}{llll}\n"," personalId & nombre & edad & nacionalidad\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p5 & Ian Stolberg & 44 & Suecia\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 1 × 4\n","\n","| personalId &lt;chr&gt; | nombre &lt;chr&gt; | edad &lt;dbl&gt; | nacionalidad &lt;chr&gt; |\n","|---|---|---|---|\n","| p5 | Ian Stolberg | 44 | Suecia |\n","\n"],"text/plain":["  personalId nombre       edad nacionalidad\n","1 p5         Ian Stolberg 44   Suecia      "]},"metadata":{},"output_type":"display_data"}],"source":["personal %>% anti_join(trabajaEn, by=\"personalId\")"]},{"cell_type":"markdown","id":"030989de","metadata":{"papermill":{"duration":0.010176,"end_time":"2023-06-17T04:43:52.843452","exception":false,"start_time":"2023-06-17T04:43:52.833276","status":"completed"},"tags":[]},"source":["## Respuesta"]},{"cell_type":"code","execution_count":12,"id":"f5fbc6e2","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.867138Z","iopub.status.busy":"2023-06-17T04:43:52.8655Z","iopub.status.idle":"2023-06-17T04:43:52.90044Z","shell.execute_reply":"2023-06-17T04:43:52.898764Z"},"papermill":{"duration":0.049074,"end_time":"2023-06-17T04:43:52.902617","exception":false,"start_time":"2023-06-17T04:43:52.853543","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 3 × 1</caption>\n","<thead>\n","\t<tr><th scope=col>personalId</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p22</td></tr>\n","\t<tr><td>p21</td></tr>\n","\t<tr><td>p33</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 3 × 1\n","\\begin{tabular}{l}\n"," personalId\\\\\n"," <chr>\\\\\n","\\hline\n","\t p22\\\\\n","\t p21\\\\\n","\t p33\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 3 × 1\n","\n","| personalId &lt;chr&gt; |\n","|---|\n","| p22 |\n","| p21 |\n","| p33 |\n","\n"],"text/plain":["  personalId\n","1 p22       \n","2 p21       \n","3 p33       "]},"metadata":{},"output_type":"display_data"}],"source":["#Código\n","P3 <- buques %>%\n","        rename(\"personalId\"=\"capitanId\") #Renombrar variable para hacer el anti_join\n","P3 <- P3 %>% anti_join(personal, by=\"personalId\") #Ver cuáles son las que no aparecen en BD personal\n","\n","P3 <- P3 %>%  \n","         select(personalId) #Mostrar solo el Id\n","\n","#Respuesta (p22, p21 y p33)\n","P3"]},{"cell_type":"markdown","id":"2fdaf31e","metadata":{"id":"vTIsD6wU39j7","papermill":{"duration":0.010284,"end_time":"2023-06-17T04:43:52.92346","exception":false,"start_time":"2023-06-17T04:43:52.913176","status":"completed"},"tags":[]},"source":["# Pregunta 4\n","Encuentre los **nombres** de el personal, con el nombre de los buques en los que trabajan, su edad y su nacionalidad, para los buques con capacidad menor o igual a 4000."]},{"cell_type":"code","execution_count":13,"id":"d9ded483","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:52.948048Z","iopub.status.busy":"2023-06-17T04:43:52.94645Z","iopub.status.idle":"2023-06-17T04:43:52.98358Z","shell.execute_reply":"2023-06-17T04:43:52.981876Z"},"papermill":{"duration":0.051854,"end_time":"2023-06-17T04:43:52.985704","exception":false,"start_time":"2023-06-17T04:43:52.93385","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A data.frame: 5 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>nombre</th><th scope=col>nombre_buque</th><th scope=col>edad</th><th scope=col>nacionalidad</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>Ian McIntosh     </td><td>Gotas Saladas</td><td>32</td><td>Escocia </td></tr>\n","\t<tr><td>Ian McIntosh     </td><td>Lento        </td><td>32</td><td>Escocia </td></tr>\n","\t<tr><td>Christian Rutter </td><td>Gotas Saladas</td><td>24</td><td>Alemania</td></tr>\n","\t<tr><td>Mark Boyle       </td><td>Lento        </td><td>33</td><td>EE.UU.  </td></tr>\n","\t<tr><td>Victoria Kostylev</td><td>Lento        </td><td>48</td><td>Chile   </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A data.frame: 5 × 4\n","\\begin{tabular}{llll}\n"," nombre & nombre\\_buque & edad & nacionalidad\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t Ian McIntosh      & Gotas Saladas & 32 & Escocia \\\\\n","\t Ian McIntosh      & Lento         & 32 & Escocia \\\\\n","\t Christian Rutter  & Gotas Saladas & 24 & Alemania\\\\\n","\t Mark Boyle        & Lento         & 33 & EE.UU.  \\\\\n","\t Victoria Kostylev & Lento         & 48 & Chile   \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A data.frame: 5 × 4\n","\n","| nombre &lt;chr&gt; | nombre_buque &lt;chr&gt; | edad &lt;dbl&gt; | nacionalidad &lt;chr&gt; |\n","|---|---|---|---|\n","| Ian McIntosh      | Gotas Saladas | 32 | Escocia  |\n","| Ian McIntosh      | Lento         | 32 | Escocia  |\n","| Christian Rutter  | Gotas Saladas | 24 | Alemania |\n","| Mark Boyle        | Lento         | 33 | EE.UU.   |\n","| Victoria Kostylev | Lento         | 48 | Chile    |\n","\n"],"text/plain":["  nombre            nombre_buque  edad nacionalidad\n","1 Ian McIntosh      Gotas Saladas 32   Escocia     \n","2 Ian McIntosh      Lento         32   Escocia     \n","3 Christian Rutter  Gotas Saladas 24   Alemania    \n","4 Mark Boyle        Lento         33   EE.UU.      \n","5 Victoria Kostylev Lento         48   Chile       "]},"metadata":{},"output_type":"display_data"}],"source":["#Código\n","P1 <- buques %>%  \n","        filter(capacidad <= 4000)  %>%  #Filtro de cap menor o igual a 400\n","        merge(trabajaEn, by = \"buqueId\") %>% #Merge con BD trabaja en\n","        rename('nombre_buque' = 'nombre') %>% #Renombrar variable nombre de BD buque\n","        merge(personal, by = \"personalId\") %>% #Merge con BD personal\n","         select(nombre, nombre_buque, edad, nacionalidad) #Mostrar únicamente las variables solicitadas\n","\n","#Respuesta (Ian McIntosh, Christian Rutter, Mark Boyle y Victoria Kostylev)\n","P1"]},{"cell_type":"markdown","id":"69146cbe","metadata":{"id":"qtV-e3OiUo1T","papermill":{"duration":0.010606,"end_time":"2023-06-17T04:43:53.007019","exception":false,"start_time":"2023-06-17T04:43:52.996413","status":"completed"},"tags":[]},"source":["# Pregunta 5\n","Encuentre los nombres de las personas trabajando para más de un buque.\n"]},{"cell_type":"markdown","id":"7c9a6558","metadata":{"papermill":{"duration":0.010535,"end_time":"2023-06-17T04:43:53.028148","exception":false,"start_time":"2023-06-17T04:43:53.017613","status":"completed"},"tags":[]},"source":["\n","### Hint\n","Puede hacer un join de una tabla consigo misma por algún atributo en común, y luego filtrar los resultados con el operador \"<\" otros dos atributos que se desea que sean distintos. Ejemplo:"]},{"cell_type":"code","execution_count":14,"id":"8b7aad76","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:53.052659Z","iopub.status.busy":"2023-06-17T04:43:53.051079Z","iopub.status.idle":"2023-06-17T04:43:53.144623Z","shell.execute_reply":"2023-06-17T04:43:53.142846Z"},"id":"rItXG17vUrNP","papermill":{"duration":0.108137,"end_time":"2023-06-17T04:43:53.146822","exception":false,"start_time":"2023-06-17T04:43:53.038685","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Warning message in inner_join(., navegaciones, by = \"navieraId\"):\n","“\u001b[1m\u001b[22mDetected an unexpected many-to-many relationship between `x` and `y`.\n","\u001b[36mℹ\u001b[39m Row 1 of `x` matches multiple rows in `y`.\n","\u001b[36mℹ\u001b[39m Row 1 of `y` matches multiple rows in `x`.\n","\u001b[36mℹ\u001b[39m If a many-to-many relationship is expected, set `relationship =\n","  \"many-to-many\"` to silence this warning.”\n"]},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 6 × 5</caption>\n","<thead>\n","\t<tr><th scope=col>buqueId.x</th><th scope=col>navieraId</th><th scope=col>ruta.x</th><th scope=col>buqueId.y</th><th scope=col>ruta.y</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>b1</td><td>n1</td><td>Chiloe Norte              </td><td>b1</td><td>Chiloe Norte              </td></tr>\n","\t<tr><td>b1</td><td>n1</td><td>Chiloe Norte              </td><td>b2</td><td>Cruce Lago General Carrera</td></tr>\n","\t<tr><td>b2</td><td>n1</td><td>Cruce Lago General Carrera</td><td>b1</td><td>Chiloe Norte              </td></tr>\n","\t<tr><td>b2</td><td>n1</td><td>Cruce Lago General Carrera</td><td>b2</td><td>Cruce Lago General Carrera</td></tr>\n","\t<tr><td>b1</td><td>n2</td><td>Puerto Murta - Chile Chico</td><td>b1</td><td>Puerto Murta - Chile Chico</td></tr>\n","\t<tr><td>b3</td><td>n3</td><td>Chaiten - Hornopiren      </td><td>b3</td><td>Chaiten - Hornopiren      </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 6 × 5\n","\\begin{tabular}{lllll}\n"," buqueId.x & navieraId & ruta.x & buqueId.y & ruta.y\\\\\n"," <chr> & <chr> & <chr> & <chr> & <chr>\\\\\n","\\hline\n","\t b1 & n1 & Chiloe Norte               & b1 & Chiloe Norte              \\\\\n","\t b1 & n1 & Chiloe Norte               & b2 & Cruce Lago General Carrera\\\\\n","\t b2 & n1 & Cruce Lago General Carrera & b1 & Chiloe Norte              \\\\\n","\t b2 & n1 & Cruce Lago General Carrera & b2 & Cruce Lago General Carrera\\\\\n","\t b1 & n2 & Puerto Murta - Chile Chico & b1 & Puerto Murta - Chile Chico\\\\\n","\t b3 & n3 & Chaiten - Hornopiren       & b3 & Chaiten - Hornopiren      \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 6 × 5\n","\n","| buqueId.x &lt;chr&gt; | navieraId &lt;chr&gt; | ruta.x &lt;chr&gt; | buqueId.y &lt;chr&gt; | ruta.y &lt;chr&gt; |\n","|---|---|---|---|---|\n","| b1 | n1 | Chiloe Norte               | b1 | Chiloe Norte               |\n","| b1 | n1 | Chiloe Norte               | b2 | Cruce Lago General Carrera |\n","| b2 | n1 | Cruce Lago General Carrera | b1 | Chiloe Norte               |\n","| b2 | n1 | Cruce Lago General Carrera | b2 | Cruce Lago General Carrera |\n","| b1 | n2 | Puerto Murta - Chile Chico | b1 | Puerto Murta - Chile Chico |\n","| b3 | n3 | Chaiten - Hornopiren       | b3 | Chaiten - Hornopiren       |\n","\n"],"text/plain":["  buqueId.x navieraId ruta.x                     buqueId.y\n","1 b1        n1        Chiloe Norte               b1       \n","2 b1        n1        Chiloe Norte               b2       \n","3 b2        n1        Cruce Lago General Carrera b1       \n","4 b2        n1        Cruce Lago General Carrera b2       \n","5 b1        n2        Puerto Murta - Chile Chico b1       \n","6 b3        n3        Chaiten - Hornopiren       b3       \n","  ruta.y                    \n","1 Chiloe Norte              \n","2 Cruce Lago General Carrera\n","3 Chiloe Norte              \n","4 Cruce Lago General Carrera\n","5 Puerto Murta - Chile Chico\n","6 Chaiten - Hornopiren      "]},"metadata":{},"output_type":"display_data"}],"source":["navegaciones %>% inner_join(navegaciones, by='navieraId')"]},{"cell_type":"markdown","id":"2b1bfd3e","metadata":{"papermill":{"duration":0.01081,"end_time":"2023-06-17T04:43:53.16867","exception":false,"start_time":"2023-06-17T04:43:53.15786","status":"completed"},"tags":[]},"source":["**Ojo, en este caso como ambas tablas tienen las mismas columnas, R les pone un sufijo a las columnas para diferenciarlas. Es mejor cambiarles el nombre previamente.**"]},{"cell_type":"markdown","id":"c5a721d9","metadata":{"papermill":{"duration":0.010738,"end_time":"2023-06-17T04:43:53.190155","exception":false,"start_time":"2023-06-17T04:43:53.179417","status":"completed"},"tags":[]},"source":["## Respuesta"]},{"cell_type":"code","execution_count":15,"id":"73b8bb8d","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:53.215167Z","iopub.status.busy":"2023-06-17T04:43:53.213583Z","iopub.status.idle":"2023-06-17T04:43:53.302237Z","shell.execute_reply":"2023-06-17T04:43:53.300443Z"},"papermill":{"duration":0.103558,"end_time":"2023-06-17T04:43:53.304452","exception":false,"start_time":"2023-06-17T04:43:53.200894","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Warning message in inner_join(., P5A, by = \"personalId\"):\n","“\u001b[1m\u001b[22mDetected an unexpected many-to-many relationship between `x` and `y`.\n","\u001b[36mℹ\u001b[39m Row 1 of `x` matches multiple rows in `y`.\n","\u001b[36mℹ\u001b[39m Row 2 of `y` matches multiple rows in `x`.\n","\u001b[36mℹ\u001b[39m If a many-to-many relationship is expected, set `relationship =\n","  \"many-to-many\"` to silence this warning.”\n"]},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A data.frame: 3 × 1</caption>\n","<thead>\n","\t<tr><th scope=col>nombre_persona</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>Ian McIntosh    </td></tr>\n","\t<tr><td>Christian Rutter</td></tr>\n","\t<tr><td>Mark Boyle      </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A data.frame: 3 × 1\n","\\begin{tabular}{l}\n"," nombre\\_persona\\\\\n"," <chr>\\\\\n","\\hline\n","\t Ian McIntosh    \\\\\n","\t Christian Rutter\\\\\n","\t Mark Boyle      \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A data.frame: 3 × 1\n","\n","| nombre_persona &lt;chr&gt; |\n","|---|\n","| Ian McIntosh     |\n","| Christian Rutter |\n","| Mark Boyle       |\n","\n"],"text/plain":["  nombre_persona  \n","1 Ian McIntosh    \n","2 Christian Rutter\n","3 Mark Boyle      "]},"metadata":{},"output_type":"display_data"}],"source":["#Código\n","\n","#Crear base original\n","P5 <- merge(personal, trabajaEn, by = \"personalId\") %>%  #Merge entre BD personal y Trabaja en\n","        rename('nombre_persona' = 'nombre') %>% #Renombrar variable nombre de BD buque\n","        merge(buques, by = \"buqueId\")  %>% #Merge con BD buques\n","        rename('nombre_buque' = 'nombre') #Renombrar variable nombre de BD buque\n","\n","#Crear copia\n","P5A <- P5 \n","names(P5A) <- c(\"buqueId_1\",\"personalId\",\"nombre_persona_1\",\"edad_1\",\"nacionalidad_1\",\"nombre_buque_1\",\"capacidad_1\",\"capitanId_1\")\n","\n","#Realizar inner join\n","P5 <- P5 %>% inner_join(P5A, by='personalId')  \n","\n","#RESPUESTA (Ian McIntosh, Christian Rutter, Mark Boyle)\n","P5 <- P5 %>% \n","        filter((nombre_persona == nombre_persona_1) & (nombre_buque != nombre_buque_1)) %>%\n","        select(nombre_persona)\n","P5 <- union(P5,P5) #Eliminar duplicados\n","P5\n"]},{"cell_type":"markdown","id":"e6b6c99b","metadata":{"id":"fWeNx_TxUrY9","papermill":{"duration":0.044893,"end_time":"2023-06-17T04:43:53.360719","exception":false,"start_time":"2023-06-17T04:43:53.315826","status":"completed"},"tags":[]},"source":["# Pregunta 6\n","Encuentre el nombre de la persona de mayor edad de la lista de personal.\n","\n","**Observacion**: NO se puede usar la funcion max()"]},{"cell_type":"markdown","id":"a19fc270","metadata":{"papermill":{"duration":0.010976,"end_time":"2023-06-17T04:43:53.383042","exception":false,"start_time":"2023-06-17T04:43:53.372066","status":"completed"},"tags":[]},"source":["\n","### Hint\n","Primero encuentre todas las personas que son menores a alguien. Luego use ese resultado para calcular los que **siempre** son mayores. Intenta usar crossing"]},{"cell_type":"code","execution_count":null,"id":"e90d0588","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:41:50.558105Z","iopub.status.busy":"2023-06-17T04:41:50.556314Z","iopub.status.idle":"2023-06-17T04:41:50.616498Z"},"papermill":{"duration":0.010889,"end_time":"2023-06-17T04:43:53.404946","exception":false,"start_time":"2023-06-17T04:43:53.394057","status":"completed"},"tags":[]},"outputs":[],"source":["\n"]},{"cell_type":"markdown","id":"5826003f","metadata":{"papermill":{"duration":0.010901,"end_time":"2023-06-17T04:43:53.426799","exception":false,"start_time":"2023-06-17T04:43:53.415898","status":"completed"},"tags":[]},"source":["## Respuesta"]},{"cell_type":"code","execution_count":16,"id":"3a449d9d","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:53.454094Z","iopub.status.busy":"2023-06-17T04:43:53.452518Z","iopub.status.idle":"2023-06-17T04:43:53.497691Z","shell.execute_reply":"2023-06-17T04:43:53.496079Z"},"papermill":{"duration":0.066631,"end_time":"2023-06-17T04:43:53.504389","exception":false,"start_time":"2023-06-17T04:43:53.437758","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 10 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_1</th><th scope=col>nombre_1</th><th scope=col>edad_1</th><th scope=col>nacionalidad_1</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 10 × 4\n","\\begin{tabular}{llll}\n"," personalId\\_1 & nombre\\_1 & edad\\_1 & nacionalidad\\_1\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p1 & Ian McIntosh      & 32 & Escocia\\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU. \\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU. \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 10 × 4\n","\n","| personalId_1 &lt;chr&gt; | nombre_1 &lt;chr&gt; | edad_1 &lt;dbl&gt; | nacionalidad_1 &lt;chr&gt; |\n","|---|---|---|---|\n","| p1 | Ian McIntosh      | 32 | Escocia |\n","| p3 | Mark Boyle        | 33 | EE.UU.  |\n","| p3 | Mark Boyle        | 33 | EE.UU.  |\n","| p4 | Victoria Kostylev | 48 | Chile   |\n","| p4 | Victoria Kostylev | 48 | Chile   |\n","| p4 | Victoria Kostylev | 48 | Chile   |\n","| p4 | Victoria Kostylev | 48 | Chile   |\n","| p5 | Ian Stolberg      | 44 | Suecia  |\n","| p5 | Ian Stolberg      | 44 | Suecia  |\n","| p5 | Ian Stolberg      | 44 | Suecia  |\n","\n"],"text/plain":["   personalId_1 nombre_1          edad_1 nacionalidad_1\n","1  p1           Ian McIntosh      32     Escocia       \n","2  p3           Mark Boyle        33     EE.UU.        \n","3  p3           Mark Boyle        33     EE.UU.        \n","4  p4           Victoria Kostylev 48     Chile         \n","5  p4           Victoria Kostylev 48     Chile         \n","6  p4           Victoria Kostylev 48     Chile         \n","7  p4           Victoria Kostylev 48     Chile         \n","8  p5           Ian Stolberg      44     Suecia        \n","9  p5           Ian Stolberg      44     Suecia        \n","10 p5           Ian Stolberg      44     Suecia        "]},"metadata":{},"output_type":"display_data"}],"source":["personal_1 <- personal\n","personal_2 <- personal\n","\n","names(personal_1) <- c(\"personalId_1\",\"nombre_1\",\"edad_1\",\"nacionalidad_1\")\n","names(personal_2) <- c(\"personalId_2\",\"nombre_2\",\"edad_3\",\"nacionalidad_4\")\n","\n","#crossing tiene problemas con los nombres de atributos repetidos, por lo tanto los cambiamos previamente\n","\n","P6 <- personal_1 %>% crossing (personal_2)\n","\n","# Pregunta: ¿Si es que comparo las edades de todos, que es lo que cumple la persona de mayor edad?\n","\n","P6A <- P6 %>% \n","        filter(edad_1 > edad_3)\n","P6A <- P6A[,1:4]\n","P6A"]},{"cell_type":"code","execution_count":17,"id":"03648e5a","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:53.531391Z","iopub.status.busy":"2023-06-17T04:43:53.529955Z","iopub.status.idle":"2023-06-17T04:43:53.592598Z","shell.execute_reply":"2023-06-17T04:43:53.59096Z"},"papermill":{"duration":0.078635,"end_time":"2023-06-17T04:43:53.594963","exception":false,"start_time":"2023-06-17T04:43:53.516328","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 16 × 8</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_1</th><th scope=col>nombre_1</th><th scope=col>edad_1</th><th scope=col>nacionalidad_1</th><th scope=col>personalId_2</th><th scope=col>nombre_2</th><th scope=col>edad_3</th><th scope=col>nacionalidad_4</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td></tr>\n","\t<tr><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td></tr>\n","\t<tr><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td></tr>\n","\t<tr><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td><td>p1</td><td>Ian McIntosh     </td><td>32</td><td>Escocia</td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU. </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile  </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 16 × 8\n","\\begin{tabular}{llllllll}\n"," personalId\\_1 & nombre\\_1 & edad\\_1 & nacionalidad\\_1 & personalId\\_2 & nombre\\_2 & edad\\_3 & nacionalidad\\_4\\\\\n"," <chr> & <chr> & <dbl> & <chr> & <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p1 & Ian McIntosh      & 32 & Escocia & p1 & Ian McIntosh      & 32 & Escocia\\\\\n","\t p1 & Ian McIntosh      & 32 & Escocia & p3 & Mark Boyle        & 33 & EE.UU. \\\\\n","\t p1 & Ian McIntosh      & 32 & Escocia & p4 & Victoria Kostylev & 48 & Chile  \\\\\n","\t p1 & Ian McIntosh      & 32 & Escocia & p5 & Ian Stolberg      & 44 & Suecia \\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU.  & p1 & Ian McIntosh      & 32 & Escocia\\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU.  & p3 & Mark Boyle        & 33 & EE.UU. \\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU.  & p4 & Victoria Kostylev & 48 & Chile  \\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU.  & p5 & Ian Stolberg      & 44 & Suecia \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile   & p1 & Ian McIntosh      & 32 & Escocia\\\\\n","\t p4 & Victoria Kostylev & 48 & Chile   & p3 & Mark Boyle        & 33 & EE.UU. \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile   & p4 & Victoria Kostylev & 48 & Chile  \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile   & p5 & Ian Stolberg      & 44 & Suecia \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia  & p1 & Ian McIntosh      & 32 & Escocia\\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia  & p3 & Mark Boyle        & 33 & EE.UU. \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia  & p4 & Victoria Kostylev & 48 & Chile  \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia  & p5 & Ian Stolberg      & 44 & Suecia \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 16 × 8\n","\n","| personalId_1 &lt;chr&gt; | nombre_1 &lt;chr&gt; | edad_1 &lt;dbl&gt; | nacionalidad_1 &lt;chr&gt; | personalId_2 &lt;chr&gt; | nombre_2 &lt;chr&gt; | edad_3 &lt;dbl&gt; | nacionalidad_4 &lt;chr&gt; |\n","|---|---|---|---|---|---|---|---|\n","| p1 | Ian McIntosh      | 32 | Escocia | p1 | Ian McIntosh      | 32 | Escocia |\n","| p1 | Ian McIntosh      | 32 | Escocia | p3 | Mark Boyle        | 33 | EE.UU.  |\n","| p1 | Ian McIntosh      | 32 | Escocia | p4 | Victoria Kostylev | 48 | Chile   |\n","| p1 | Ian McIntosh      | 32 | Escocia | p5 | Ian Stolberg      | 44 | Suecia  |\n","| p3 | Mark Boyle        | 33 | EE.UU.  | p1 | Ian McIntosh      | 32 | Escocia |\n","| p3 | Mark Boyle        | 33 | EE.UU.  | p3 | Mark Boyle        | 33 | EE.UU.  |\n","| p3 | Mark Boyle        | 33 | EE.UU.  | p4 | Victoria Kostylev | 48 | Chile   |\n","| p3 | Mark Boyle        | 33 | EE.UU.  | p5 | Ian Stolberg      | 44 | Suecia  |\n","| p4 | Victoria Kostylev | 48 | Chile   | p1 | Ian McIntosh      | 32 | Escocia |\n","| p4 | Victoria Kostylev | 48 | Chile   | p3 | Mark Boyle        | 33 | EE.UU.  |\n","| p4 | Victoria Kostylev | 48 | Chile   | p4 | Victoria Kostylev | 48 | Chile   |\n","| p4 | Victoria Kostylev | 48 | Chile   | p5 | Ian Stolberg      | 44 | Suecia  |\n","| p5 | Ian Stolberg      | 44 | Suecia  | p1 | Ian McIntosh      | 32 | Escocia |\n","| p5 | Ian Stolberg      | 44 | Suecia  | p3 | Mark Boyle        | 33 | EE.UU.  |\n","| p5 | Ian Stolberg      | 44 | Suecia  | p4 | Victoria Kostylev | 48 | Chile   |\n","| p5 | Ian Stolberg      | 44 | Suecia  | p5 | Ian Stolberg      | 44 | Suecia  |\n","\n"],"text/plain":["   personalId_1 nombre_1          edad_1 nacionalidad_1 personalId_2\n","1  p1           Ian McIntosh      32     Escocia        p1          \n","2  p1           Ian McIntosh      32     Escocia        p3          \n","3  p1           Ian McIntosh      32     Escocia        p4          \n","4  p1           Ian McIntosh      32     Escocia        p5          \n","5  p3           Mark Boyle        33     EE.UU.         p1          \n","6  p3           Mark Boyle        33     EE.UU.         p3          \n","7  p3           Mark Boyle        33     EE.UU.         p4          \n","8  p3           Mark Boyle        33     EE.UU.         p5          \n","9  p4           Victoria Kostylev 48     Chile          p1          \n","10 p4           Victoria Kostylev 48     Chile          p3          \n","11 p4           Victoria Kostylev 48     Chile          p4          \n","12 p4           Victoria Kostylev 48     Chile          p5          \n","13 p5           Ian Stolberg      44     Suecia         p1          \n","14 p5           Ian Stolberg      44     Suecia         p3          \n","15 p5           Ian Stolberg      44     Suecia         p4          \n","16 p5           Ian Stolberg      44     Suecia         p5          \n","   nombre_2          edad_3 nacionalidad_4\n","1  Ian McIntosh      32     Escocia       \n","2  Mark Boyle        33     EE.UU.        \n","3  Victoria Kostylev 48     Chile         \n","4  Ian Stolberg      44     Suecia        \n","5  Ian McIntosh      32     Escocia       \n","6  Mark Boyle        33     EE.UU.        \n","7  Victoria Kostylev 48     Chile         \n","8  Ian Stolberg      44     Suecia        \n","9  Ian McIntosh      32     Escocia       \n","10 Mark Boyle        33     EE.UU.        \n","11 Victoria Kostylev 48     Chile         \n","12 Ian Stolberg      44     Suecia        \n","13 Ian McIntosh      32     Escocia       \n","14 Mark Boyle        33     EE.UU.        \n","15 Victoria Kostylev 48     Chile         \n","16 Ian Stolberg      44     Suecia        "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 6 × 8</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_1</th><th scope=col>nombre_1</th><th scope=col>edad_1</th><th scope=col>nacionalidad_1</th><th scope=col>personalId_2</th><th scope=col>nombre_2</th><th scope=col>edad_3</th><th scope=col>nacionalidad_4</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td><td>p1</td><td>Ian McIntosh</td><td>32</td><td>Escocia</td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td><td>p1</td><td>Ian McIntosh</td><td>32</td><td>Escocia</td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td><td>p3</td><td>Mark Boyle  </td><td>33</td><td>EE.UU. </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td><td>p5</td><td>Ian Stolberg</td><td>44</td><td>Suecia </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td><td>p1</td><td>Ian McIntosh</td><td>32</td><td>Escocia</td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td><td>p3</td><td>Mark Boyle  </td><td>33</td><td>EE.UU. </td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 6 × 8\n","\\begin{tabular}{llllllll}\n"," personalId\\_1 & nombre\\_1 & edad\\_1 & nacionalidad\\_1 & personalId\\_2 & nombre\\_2 & edad\\_3 & nacionalidad\\_4\\\\\n"," <chr> & <chr> & <dbl> & <chr> & <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p3 & Mark Boyle        & 33 & EE.UU. & p1 & Ian McIntosh & 32 & Escocia\\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  & p1 & Ian McIntosh & 32 & Escocia\\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  & p3 & Mark Boyle   & 33 & EE.UU. \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  & p5 & Ian Stolberg & 44 & Suecia \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia & p1 & Ian McIntosh & 32 & Escocia\\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia & p3 & Mark Boyle   & 33 & EE.UU. \\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 6 × 8\n","\n","| personalId_1 &lt;chr&gt; | nombre_1 &lt;chr&gt; | edad_1 &lt;dbl&gt; | nacionalidad_1 &lt;chr&gt; | personalId_2 &lt;chr&gt; | nombre_2 &lt;chr&gt; | edad_3 &lt;dbl&gt; | nacionalidad_4 &lt;chr&gt; |\n","|---|---|---|---|---|---|---|---|\n","| p3 | Mark Boyle        | 33 | EE.UU. | p1 | Ian McIntosh | 32 | Escocia |\n","| p4 | Victoria Kostylev | 48 | Chile  | p1 | Ian McIntosh | 32 | Escocia |\n","| p4 | Victoria Kostylev | 48 | Chile  | p3 | Mark Boyle   | 33 | EE.UU.  |\n","| p4 | Victoria Kostylev | 48 | Chile  | p5 | Ian Stolberg | 44 | Suecia  |\n","| p5 | Ian Stolberg      | 44 | Suecia | p1 | Ian McIntosh | 32 | Escocia |\n","| p5 | Ian Stolberg      | 44 | Suecia | p3 | Mark Boyle   | 33 | EE.UU.  |\n","\n"],"text/plain":["  personalId_1 nombre_1          edad_1 nacionalidad_1 personalId_2\n","1 p3           Mark Boyle        33     EE.UU.         p1          \n","2 p4           Victoria Kostylev 48     Chile          p1          \n","3 p4           Victoria Kostylev 48     Chile          p3          \n","4 p4           Victoria Kostylev 48     Chile          p5          \n","5 p5           Ian Stolberg      44     Suecia         p1          \n","6 p5           Ian Stolberg      44     Suecia         p3          \n","  nombre_2     edad_3 nacionalidad_4\n","1 Ian McIntosh 32     Escocia       \n","2 Ian McIntosh 32     Escocia       \n","3 Mark Boyle   33     EE.UU.        \n","4 Ian Stolberg 44     Suecia        \n","5 Ian McIntosh 32     Escocia       \n","6 Mark Boyle   33     EE.UU.        "]},"metadata":{},"output_type":"display_data"}],"source":["# Renombrar nueva base con valores filtrados\n","P6B <- P6A\n","names(P6B) <- c(\"personalId_2\",\"nombre_2\",\"edad_3\",\"nacionalidad_4\")\n","\n","# Nuevo crossing con menor número de obs\n","P62 <- P6A %>% crossing (P6B)\n","P62\n","\n","# Nuevo Filtro\n","P62 <- P62 %>%\n","        filter(edad_1 > edad_3)\n","P62\n"]},{"cell_type":"code","execution_count":18,"id":"704e3c53","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:53.622917Z","iopub.status.busy":"2023-06-17T04:43:53.621413Z","iopub.status.idle":"2023-06-17T04:43:53.69061Z","shell.execute_reply":"2023-06-17T04:43:53.68899Z"},"papermill":{"duration":0.085635,"end_time":"2023-06-17T04:43:53.692931","exception":false,"start_time":"2023-06-17T04:43:53.607296","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 6 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_1</th><th scope=col>nombre_1</th><th scope=col>edad_1</th><th scope=col>nacionalidad_1</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 6 × 4\n","\\begin{tabular}{llll}\n"," personalId\\_1 & nombre\\_1 & edad\\_1 & nacionalidad\\_1\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p3 & Mark Boyle        & 33 & EE.UU.\\\\\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 6 × 4\n","\n","| personalId_1 &lt;chr&gt; | nombre_1 &lt;chr&gt; | edad_1 &lt;dbl&gt; | nacionalidad_1 &lt;chr&gt; |\n","|---|---|---|---|\n","| p3 | Mark Boyle        | 33 | EE.UU. |\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p5 | Ian Stolberg      | 44 | Suecia |\n","| p5 | Ian Stolberg      | 44 | Suecia |\n","\n"],"text/plain":["  personalId_1 nombre_1          edad_1 nacionalidad_1\n","1 p3           Mark Boyle        33     EE.UU.        \n","2 p4           Victoria Kostylev 48     Chile         \n","3 p4           Victoria Kostylev 48     Chile         \n","4 p4           Victoria Kostylev 48     Chile         \n","5 p5           Ian Stolberg      44     Suecia        \n","6 p5           Ian Stolberg      44     Suecia        "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 6 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_2</th><th scope=col>nombre_2</th><th scope=col>edad_3</th><th scope=col>nacionalidad_4</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 6 × 4\n","\\begin{tabular}{llll}\n"," personalId\\_2 & nombre\\_2 & edad\\_3 & nacionalidad\\_4\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p3 & Mark Boyle        & 33 & EE.UU.\\\\\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 6 × 4\n","\n","| personalId_2 &lt;chr&gt; | nombre_2 &lt;chr&gt; | edad_3 &lt;dbl&gt; | nacionalidad_4 &lt;chr&gt; |\n","|---|---|---|---|\n","| p3 | Mark Boyle        | 33 | EE.UU. |\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p5 | Ian Stolberg      | 44 | Suecia |\n","| p5 | Ian Stolberg      | 44 | Suecia |\n","\n"],"text/plain":["  personalId_2 nombre_2          edad_3 nacionalidad_4\n","1 p3           Mark Boyle        33     EE.UU.        \n","2 p4           Victoria Kostylev 48     Chile         \n","3 p4           Victoria Kostylev 48     Chile         \n","4 p4           Victoria Kostylev 48     Chile         \n","5 p5           Ian Stolberg      44     Suecia        \n","6 p5           Ian Stolberg      44     Suecia        "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 9 × 8</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_1</th><th scope=col>nombre_1</th><th scope=col>edad_1</th><th scope=col>nacionalidad_1</th><th scope=col>personalId_2</th><th scope=col>nombre_2</th><th scope=col>edad_3</th><th scope=col>nacionalidad_4</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td><td>p3</td><td>Mark Boyle       </td><td>33</td><td>EE.UU.</td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 9 × 8\n","\\begin{tabular}{llllllll}\n"," personalId\\_1 & nombre\\_1 & edad\\_1 & nacionalidad\\_1 & personalId\\_2 & nombre\\_2 & edad\\_3 & nacionalidad\\_4\\\\\n"," <chr> & <chr> & <dbl> & <chr> & <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p3 & Mark Boyle        & 33 & EE.UU. & p3 & Mark Boyle        & 33 & EE.UU.\\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU. & p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p3 & Mark Boyle        & 33 & EE.UU. & p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  & p3 & Mark Boyle        & 33 & EE.UU.\\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  & p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  & p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia & p3 & Mark Boyle        & 33 & EE.UU.\\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia & p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia & p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 9 × 8\n","\n","| personalId_1 &lt;chr&gt; | nombre_1 &lt;chr&gt; | edad_1 &lt;dbl&gt; | nacionalidad_1 &lt;chr&gt; | personalId_2 &lt;chr&gt; | nombre_2 &lt;chr&gt; | edad_3 &lt;dbl&gt; | nacionalidad_4 &lt;chr&gt; |\n","|---|---|---|---|---|---|---|---|\n","| p3 | Mark Boyle        | 33 | EE.UU. | p3 | Mark Boyle        | 33 | EE.UU. |\n","| p3 | Mark Boyle        | 33 | EE.UU. | p4 | Victoria Kostylev | 48 | Chile  |\n","| p3 | Mark Boyle        | 33 | EE.UU. | p5 | Ian Stolberg      | 44 | Suecia |\n","| p4 | Victoria Kostylev | 48 | Chile  | p3 | Mark Boyle        | 33 | EE.UU. |\n","| p4 | Victoria Kostylev | 48 | Chile  | p4 | Victoria Kostylev | 48 | Chile  |\n","| p4 | Victoria Kostylev | 48 | Chile  | p5 | Ian Stolberg      | 44 | Suecia |\n","| p5 | Ian Stolberg      | 44 | Suecia | p3 | Mark Boyle        | 33 | EE.UU. |\n","| p5 | Ian Stolberg      | 44 | Suecia | p4 | Victoria Kostylev | 48 | Chile  |\n","| p5 | Ian Stolberg      | 44 | Suecia | p5 | Ian Stolberg      | 44 | Suecia |\n","\n"],"text/plain":["  personalId_1 nombre_1          edad_1 nacionalidad_1 personalId_2\n","1 p3           Mark Boyle        33     EE.UU.         p3          \n","2 p3           Mark Boyle        33     EE.UU.         p4          \n","3 p3           Mark Boyle        33     EE.UU.         p5          \n","4 p4           Victoria Kostylev 48     Chile          p3          \n","5 p4           Victoria Kostylev 48     Chile          p4          \n","6 p4           Victoria Kostylev 48     Chile          p5          \n","7 p5           Ian Stolberg      44     Suecia         p3          \n","8 p5           Ian Stolberg      44     Suecia         p4          \n","9 p5           Ian Stolberg      44     Suecia         p5          \n","  nombre_2          edad_3 nacionalidad_4\n","1 Mark Boyle        33     EE.UU.        \n","2 Victoria Kostylev 48     Chile         \n","3 Ian Stolberg      44     Suecia        \n","4 Mark Boyle        33     EE.UU.        \n","5 Victoria Kostylev 48     Chile         \n","6 Ian Stolberg      44     Suecia        \n","7 Mark Boyle        33     EE.UU.        \n","8 Victoria Kostylev 48     Chile         \n","9 Ian Stolberg      44     Suecia        "]},"metadata":{},"output_type":"display_data"}],"source":["# Renombrar nueva base con valores filtrados\n","P62 <- P62[,1:4]\n","P62\n","\n","P62_2 <- P62\n","names(P62_2) <- c(\"personalId_2\",\"nombre_2\",\"edad_3\",\"nacionalidad_4\")\n","P62_2\n","\n","# Nuevo crossing con menor número de obs\n","P63 <- P62 %>% crossing (P62_2)\n","P63\n","\n","# Nuevo Filtro\n","P63 <- P63 %>%\n","    filter(edad_1 > edad_3) "]},{"cell_type":"code","execution_count":19,"id":"b42a022e","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:53.721994Z","iopub.status.busy":"2023-06-17T04:43:53.720347Z","iopub.status.idle":"2023-06-17T04:43:53.790867Z","shell.execute_reply":"2023-06-17T04:43:53.789261Z"},"papermill":{"duration":0.0874,"end_time":"2023-06-17T04:43:53.793133","exception":false,"start_time":"2023-06-17T04:43:53.705733","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 3 × 4</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_1</th><th scope=col>nombre_1</th><th scope=col>edad_1</th><th scope=col>nacionalidad_1</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 3 × 4\n","\\begin{tabular}{llll}\n"," personalId\\_1 & nombre\\_1 & edad\\_1 & nacionalidad\\_1\\\\\n"," <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 3 × 4\n","\n","| personalId_1 &lt;chr&gt; | nombre_1 &lt;chr&gt; | edad_1 &lt;dbl&gt; | nacionalidad_1 &lt;chr&gt; |\n","|---|---|---|---|\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p4 | Victoria Kostylev | 48 | Chile  |\n","| p5 | Ian Stolberg      | 44 | Suecia |\n","\n"],"text/plain":["  personalId_1 nombre_1          edad_1 nacionalidad_1\n","1 p4           Victoria Kostylev 48     Chile         \n","2 p4           Victoria Kostylev 48     Chile         \n","3 p5           Ian Stolberg      44     Suecia        "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 4 × 8</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_1</th><th scope=col>nombre_1</th><th scope=col>edad_1</th><th scope=col>nacionalidad_1</th><th scope=col>personalId_2</th><th scope=col>nombre_2</th><th scope=col>edad_3</th><th scope=col>nacionalidad_4</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile </td></tr>\n","\t<tr><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td><td>p5</td><td>Ian Stolberg     </td><td>44</td><td>Suecia</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 4 × 8\n","\\begin{tabular}{llllllll}\n"," personalId\\_1 & nombre\\_1 & edad\\_1 & nacionalidad\\_1 & personalId\\_2 & nombre\\_2 & edad\\_3 & nacionalidad\\_4\\\\\n"," <chr> & <chr> & <dbl> & <chr> & <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p4 & Victoria Kostylev & 48 & Chile  & p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p4 & Victoria Kostylev & 48 & Chile  & p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia & p4 & Victoria Kostylev & 48 & Chile \\\\\n","\t p5 & Ian Stolberg      & 44 & Suecia & p5 & Ian Stolberg      & 44 & Suecia\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 4 × 8\n","\n","| personalId_1 &lt;chr&gt; | nombre_1 &lt;chr&gt; | edad_1 &lt;dbl&gt; | nacionalidad_1 &lt;chr&gt; | personalId_2 &lt;chr&gt; | nombre_2 &lt;chr&gt; | edad_3 &lt;dbl&gt; | nacionalidad_4 &lt;chr&gt; |\n","|---|---|---|---|---|---|---|---|\n","| p4 | Victoria Kostylev | 48 | Chile  | p4 | Victoria Kostylev | 48 | Chile  |\n","| p4 | Victoria Kostylev | 48 | Chile  | p5 | Ian Stolberg      | 44 | Suecia |\n","| p5 | Ian Stolberg      | 44 | Suecia | p4 | Victoria Kostylev | 48 | Chile  |\n","| p5 | Ian Stolberg      | 44 | Suecia | p5 | Ian Stolberg      | 44 | Suecia |\n","\n"],"text/plain":["  personalId_1 nombre_1          edad_1 nacionalidad_1 personalId_2\n","1 p4           Victoria Kostylev 48     Chile          p4          \n","2 p4           Victoria Kostylev 48     Chile          p5          \n","3 p5           Ian Stolberg      44     Suecia         p4          \n","4 p5           Ian Stolberg      44     Suecia         p5          \n","  nombre_2          edad_3 nacionalidad_4\n","1 Victoria Kostylev 48     Chile         \n","2 Ian Stolberg      44     Suecia        \n","3 Victoria Kostylev 48     Chile         \n","4 Ian Stolberg      44     Suecia        "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 1 × 8</caption>\n","<thead>\n","\t<tr><th scope=col>personalId_1</th><th scope=col>nombre_1</th><th scope=col>edad_1</th><th scope=col>nacionalidad_1</th><th scope=col>personalId_2</th><th scope=col>nombre_2</th><th scope=col>edad_3</th><th scope=col>nacionalidad_4</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>p4</td><td>Victoria Kostylev</td><td>48</td><td>Chile</td><td>p5</td><td>Ian Stolberg</td><td>44</td><td>Suecia</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 1 × 8\n","\\begin{tabular}{llllllll}\n"," personalId\\_1 & nombre\\_1 & edad\\_1 & nacionalidad\\_1 & personalId\\_2 & nombre\\_2 & edad\\_3 & nacionalidad\\_4\\\\\n"," <chr> & <chr> & <dbl> & <chr> & <chr> & <chr> & <dbl> & <chr>\\\\\n","\\hline\n","\t p4 & Victoria Kostylev & 48 & Chile & p5 & Ian Stolberg & 44 & Suecia\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 1 × 8\n","\n","| personalId_1 &lt;chr&gt; | nombre_1 &lt;chr&gt; | edad_1 &lt;dbl&gt; | nacionalidad_1 &lt;chr&gt; | personalId_2 &lt;chr&gt; | nombre_2 &lt;chr&gt; | edad_3 &lt;dbl&gt; | nacionalidad_4 &lt;chr&gt; |\n","|---|---|---|---|---|---|---|---|\n","| p4 | Victoria Kostylev | 48 | Chile | p5 | Ian Stolberg | 44 | Suecia |\n","\n"],"text/plain":["  personalId_1 nombre_1          edad_1 nacionalidad_1 personalId_2\n","1 p4           Victoria Kostylev 48     Chile          p5          \n","  nombre_2     edad_3 nacionalidad_4\n","1 Ian Stolberg 44     Suecia        "]},"metadata":{},"output_type":"display_data"}],"source":["# Renombrar nueva base con valores filtrados\n","P63 <- P63[,1:4]\n","P63\n","\n","P63_2 <- P63\n","names(P63_2) <- c(\"personalId_2\",\"nombre_2\",\"edad_3\",\"nacionalidad_4\")\n","\n","# Nuevo crossing con menor número de obs\n","P64 <- P63 %>% crossing (P63_2)\n","P64\n","\n","# Nuevo Filtro\n","P64 <- P64 %>%\n","        filter(edad_1 > edad_3) \n","P64"]},{"cell_type":"code","execution_count":20,"id":"e24c0446","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:53.822834Z","iopub.status.busy":"2023-06-17T04:43:53.821388Z","iopub.status.idle":"2023-06-17T04:43:53.843716Z","shell.execute_reply":"2023-06-17T04:43:53.842175Z"},"papermill":{"duration":0.039448,"end_time":"2023-06-17T04:43:53.845908","exception":false,"start_time":"2023-06-17T04:43:53.80646","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A tibble: 1 × 1</caption>\n","<thead>\n","\t<tr><th scope=col>nombre_1</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>Victoria Kostylev</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A tibble: 1 × 1\n","\\begin{tabular}{l}\n"," nombre\\_1\\\\\n"," <chr>\\\\\n","\\hline\n","\t Victoria Kostylev\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A tibble: 1 × 1\n","\n","| nombre_1 &lt;chr&gt; |\n","|---|\n","| Victoria Kostylev |\n","\n"],"text/plain":["  nombre_1         \n","1 Victoria Kostylev"]},"metadata":{},"output_type":"display_data"}],"source":["#Respuesta (Victoria Kostylev)\n","P64 %>% select(nombre_1)"]},{"cell_type":"markdown","id":"7fd270e3","metadata":{"id":"G5bRkUl3Uwja","papermill":{"duration":0.013124,"end_time":"2023-06-17T04:43:53.872515","exception":false,"start_time":"2023-06-17T04:43:53.859391","status":"completed"},"tags":[]},"source":["# Pregunta 7\n","Encuentre los nombres de todos los buques trabajando para una naviera chilena."]},{"cell_type":"markdown","id":"510f2031","metadata":{"papermill":{"duration":0.013124,"end_time":"2023-06-17T04:43:53.898862","exception":false,"start_time":"2023-06-17T04:43:53.885738","status":"completed"},"tags":[]},"source":["## Respuesta"]},{"cell_type":"code","execution_count":21,"id":"80ea435a","metadata":{"execution":{"iopub.execute_input":"2023-06-17T04:43:53.929055Z","iopub.status.busy":"2023-06-17T04:43:53.927552Z","iopub.status.idle":"2023-06-17T04:43:53.961251Z","shell.execute_reply":"2023-06-17T04:43:53.959443Z"},"id":"52jjtxLuUylt","papermill":{"duration":0.051462,"end_time":"2023-06-17T04:43:53.963453","exception":false,"start_time":"2023-06-17T04:43:53.911991","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<table class=\"dataframe\">\n","<caption>A data.frame: 2 × 1</caption>\n","<thead>\n","\t<tr><th scope=col>nombre_buque</th></tr>\n","\t<tr><th scope=col>&lt;chr&gt;</th></tr>\n","</thead>\n","<tbody>\n","\t<tr><td>El Inundado  </td></tr>\n","\t<tr><td>Gotas Saladas</td></tr>\n","</tbody>\n","</table>\n"],"text/latex":["A data.frame: 2 × 1\n","\\begin{tabular}{l}\n"," nombre\\_buque\\\\\n"," <chr>\\\\\n","\\hline\n","\t El Inundado  \\\\\n","\t Gotas Saladas\\\\\n","\\end{tabular}\n"],"text/markdown":["\n","A data.frame: 2 × 1\n","\n","| nombre_buque &lt;chr&gt; |\n","|---|\n","| El Inundado   |\n","| Gotas Saladas |\n","\n"],"text/plain":["  nombre_buque \n","1 El Inundado  \n","2 Gotas Saladas"]},"metadata":{},"output_type":"display_data"}],"source":["#Código\n","P7 <- merge(buques, navegaciones, by = \"buqueId\") %>%  #Merge entre BD buques y navegaciones\n","        merge(navieras, by = \"navieraId\") %>%   #Merge con BD naviera\n","        filter(pais=='Chile')  %>%  #Filtro solo para Chile\n","        rename('nombre_buque' = 'nombre.x') %>% #Renombrar variable nombre de BD buque\n","        select(nombre_buque)\n","\n","P7 <- union(P7,P7) #Eliminar duplicados\n","\n","#Respuesta: El Inundado, Gotas Saladas\n","P7"]}],"metadata":{"colab":{"collapsed_sections":[],"include_colab_link":true,"name":"Tarea_1.ipynb","provenance":[]},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":6.294392,"end_time":"2023-06-17T04:43:54.099082","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2023-06-17T04:43:47.80469","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}